print(paste("Greg =", gregVar[1], " + ", gregVar[2], "GPAHS + ", ))
print(paste("Greg =", gregVar[1], " + ", gregVar[2], "GPAHS + " ))
print(paste("Greg =", gregVar[1], " + ", gregVar[2], "*GPAHS + " ))
print(paste("Greg =", gregVar[1], "+", gregVar[2], "*GPAHS +" ))
gregVar
print(paste("Greg =", gregVar[1], "+", gregVar[2], "*GPAHS +", gregVar[3], "AccRate +", gregVar[4], "Endow"))
print(paste("Greg =", gregVar[1], "+",gregVar[2], "GPAHS +", gregVar[3], "AccRate", gregVar[4], "Endow"))
print(paste("Greg =", gregVar[1], "+",gregVar[2], "GPAHS", gregVar[3], "AccRate +", gregVar[4], "Endow"))
round(gregVar,2)
library(tidyverse)
gregVar <- summary(GregLM)$coefficients[summary(GregLM)$coefficients[,4] < pval,1] %>% round(2)
gregVar
juliaVar <- summary(JuliaLM)$coefficients[summary(JuliaLM)$coefficients[,4] < pval,1] %>% round(2#intercept 62480.7999
juliaVar <- summary(JuliaLM)$coefficients[summary(JuliaLM)$coefficients[,4] < pval,1] %>% round(2)#intercept 62480.7999
juliaVar <- summary(JuliaLM)$coefficients[summary(JuliaLM)$coefficients[,4] < pval,1] %>% round(2)#intercept 62480.7999
leoVar <- summary(LeoLM)$coefficients[summary(LeoLM)$coefficients[,4] < pval,1] %>% round(@)
leoVar <- summary(LeoLM)$coefficients[summary(LeoLM)$coefficients[,4] < pval,1] %>% round(2)
print(paste("Greg =", gregVar[1], "+",gregVar[2], "GPAHS", gregVar[3], "AccRate +", gregVar[4], "Endow"))
smitVar
print(paste("Smit =", smitVar[1], "+",smitVar[2], "GPAHS"))
smitVar <- summary(SmitLM)$coefficients[summary(SmitLM)$coefficients[,4] < pval,1] %>% round(2)
print(paste("Smit =", smitVar[1], "+",smitVar[2], "GPAHS"))
juliaVar <- summary(JuliaLM)$coefficients[summary(JuliaLM)$coefficients[,4] < pval,1] %>% round(2)#intercept 62480.7999
juliaVar
print(paste("Julia = 62480.80 +",juliaVar[1], "Meaning", juliaVar[2], "Stem +", juliaVar[3], "Endow"))
GregLM$fitted.values
summary(GregLM)$coefficients[,4] < pval
summary(SmitLM)$coefficients[,4] < pval
summary(JuliaLM)$coefficients[,4] < pval
summary(FreyaLM)$coefficients[,4] < pval
summary(GregLM)$coefficients[,4] < pval
summary(SmitLM)$coefficients[,4] < pval
summary(JuliaLM)$coefficients[,4] < pval
summary(FreyaLM)$coefficients[,4] < pval
summary(LeoLM)$coefficients[,4] < pval
GregLM
summary(GregLM)$coefficients[,4] < pval
names(summary(GregLM))
names(summary(GregLM)$coefficients)
summary(GregLM)$coefficients
rownames(summary(GregLM)$coefficients)
rownames(summary(GregLM)$coefficients)
rownames(summary(GregLM)$coefficients)[summary(a)$coefficients[,4] < pval]
a <- GregLM
rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
a <- SmitLM
a <- JuliaLM
rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
a <- FreyaLM
rownames(summary(FreyaLM)$coefficients)
a <- LeoLM
rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
lm(Greg~GregVar, data = Greg)
GregVar <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
lm(Greg~GregVar, data = Greg)
GregVar
as.formula(paste("Greg ~", paste(GregVar[-1], collapse = " + ")))
a <- GregLM
GregVar <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
as.formula(paste("Greg ~", paste(GregVar[-1], collapse = " + ")))
lm(as.formula(paste("Greg ~", paste(GregVar[-1], collapse = " + "))), data = Greg)
lm(as.formula(paste("Greg ~", paste(Var[-1], collapse = " + "))), data = Greg)
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
lm(as.formula(paste("Greg ~", paste(Var[-1], collapse = " + "))), data = Greg)
a <- SmitLM
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
lm(as.formula(paste("Smit ~", paste(Var[-1], collapse = " + "))), data = Smit)
a <- GregLM
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
lm(as.formula(paste("Greg ~", paste(Var[-1], collapse = " + "))), data = Greg)
a <- SmitLM
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
lm(as.formula(paste("Smit ~", paste(Var[-1], collapse = " + "))), data = Smit)
a <- SmitLM
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
Var
a <- JuliaLM
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
Var
JuliaLM.N <- lm(as.formula(paste("Julia ~", paste(Var, collapse = " + "))), data = Julia)
a <- LeoLM
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
Var
LeoLM.N <- lm(as.formula(paste("Leo ~", paste(Var[-1], collapse = " + "))), data = Leo)
Var
LeoLM.N <- lm(as.formula(paste("Leo ~", paste(Var[-1], collapse = " + "))), data = Leo)
GregLM.N
pval <- 0.05
a <- GregLM
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
GregLM.N <- lm(as.formula(paste("Greg ~", paste(Var[-1], collapse = " + "))), data = Greg)
a <- SmitLM
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
SmitLM.N <- lm(as.formula(paste("Smit ~", paste(Var[-1], collapse = " + "))), data = Smit)
a <- JuliaLM
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
JuliaLM.N <- lm(as.formula(paste("Julia ~", paste(Var, collapse = " + "))), data = Julia)
a <- FreyaLM
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
Var
FreyaLM.N <- lm(as.formula(paste("Freya ~", paste(Var, collapse = " + "))), data = Freya)
a <- LeoLM
Var <- rownames(summary(a)$coefficients)[summary(a)$coefficients[,4] < pval]
Var
LeoLM.N <- lm(as.formula(paste("Leo ~", paste(Var[-1], collapse = " + "))), data = Leo)
GregLM.N
SmitLM.N
JuliaLM.N
FreyaLM.N
data.frame(Greg = Greg$Greg, GregFit = GregLM$fitted.values, GregResid)
data.frame(Greg = Greg$Greg, GregFit = GregLM$fitted.values)
data.frame("Greg" = Greg$Greg, GregFit = GregLM$fitted.values)
names <- c("Greg", "Smit", "Julia", "Freya", "Leo")
data.frame(names[1] = Greg$Greg, GregFit = GregLM$fitted.values, GregResid)
data.frame(Greg = Greg$Greg, GregFit = GregLM$fitted.values, GregResid)
data.frame(Greg = Greg$Greg, GregFit = GregLM.N$fitted.values, GregResid = GregLM.N$residuals)
data.frame(Greg = Greg$Greg, GregFit = GregLM.N$fitted.values, GregResid = GregLM.N$residuals)
data.frame(Smit = Smit$Smit, SmitFit = SmitLM.N$fitted.values, SmitResid = SmitLM.N$residuals)
data.frame(Julia = Julia$Julia, JuliaFit = JuliaLM.N$fitted.values, JuliaResid = JuliaLM.N$residuals)
Greg5 <- data.frame(Greg = Greg$Greg, GregFit = GregLM.N$fitted.values, GregResid = GregLM.N$residuals)
Smit5 <- data.frame(Smit = Smit$Smit, SmitFit = SmitLM.N$fitted.values, SmitResid = SmitLM.N$residuals)
Julia5 <- data.frame(Julia = Julia$Julia, JuliaFit = JuliaLM.N$fitted.values, JuliaResid = JuliaLM.N$residuals)
Freya5 <- data.frame(Freya = Freya$Freya, FreyaFit = FreyaLM.N$fitted.values, FreyaResid = FreyaLM.N$residuals)
Leo5 <- data.frame(Leo = Leo$Leo, LeoFit = LeoLM.N$fitted.values, LeoResid = LeoLM.N$residuals)
list(Greg5, Smit5, Julia5, Freya5, Leo5)
list(Greg5, Smit5, Julia5)#, Freya5, Leo5)
datalist <- list(Greg5, Smit5, Julia5)#, Freya5, Leo5)
fit.resid <- list(Greg5, Smit5, Julia5)#, Freya5, Leo5)
orig.datas <- list(Greg,Smit,Julia,Freya,Leo)
members <- c("Greg", "Smit", "Julia", "Freya", "Leo")
GregLM <- lm(Greg~., data = orig.datas[1])
orig.datas[1]
Greg
orig.datas[1]
GregLM <- lm(Greg~., data = orig.datas[1])
GregLM <- lm(Greg~., data = Greg)
SmitLM <- lm(Smit~.,data = Smit)
seq(1,5)
fit.resid[2]
cor(fit.resid[1][,1],fit.resid[1][,2])
fit.resid[1][,1]
fit.resid[1]
fit.resid[1][1]
fit.resid[1][[,1]]
fit.resid[1]
fit.resid[[1]][,1]
Greg5
fit.resid[[1]][,1]
cor(fit.resid[1][,1],fit.resid[1][,2])
cor(fit.resid[[1]][,1],fit.resid[[1]][,2])
corrs = NULL
corrs
corrs[i] = corr
corrs = NULL
for (i in seq(1,3)){
data = fit.resid[i]
corr = cor(fit.resid[[i]][,1],fit.resid[[i]][,2])
corrs[i] = corr
}
corrs
for (i in seq(1,length(fit.resid))){
data = fit.resid[i]
corr = cor(fit.resid[[i]][,1],fit.resid[[i]][,2])
corrs[i] = corr
}
corrs
corrs = NULL
for (i in seq(1,length(fit.resid))){
data = fit.resid[i]
corr = cor(fit.resid[[i]][,1],fit.resid[[i]][,2])
corrs[i] = corr
}
corrs
lmlist <- (GregLM,SmitLM,JuliaLM,FreyaLM,LeoLM)
lmlist <- list(GregLM,SmitLM,JuliaLM,FreyaLM,LeoLM)
lmlist <- list(GregLM,SmitLM,JuliaLM)#,FreyaLM,LeoLM)
library(readxl)
library(tidyverse)
sheet_names <- c("Greg Judgements", "Smit Judgements", "Julia Judgements", "Freya Judgements", "Leo Judgements")
members <- c("Greg", "Smit", "Julia", "Freya", "Leo")
Greg <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[1])
Smit <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[2])
sheet_names <- c("Greg Judgements", "Smit Judgements", "Julia Judgements", "Freya Judgements", "Leo Judgements")
members <- c("Greg", "Smit", "Julia", "Freya", "Leo")
Greg <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[1])
Greg <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[1])
library(readxl)
Greg <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[1])
Greg <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[1])
library(readxl)
library(tidyverse)
sheet_names <- c("Greg Judgements", "Smit Judgements", "Julia Judgements", "Freya Judgements", "Leo Judgements")
members <- c("Greg", "Smit", "Julia", "Freya", "Leo")
Greg <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[1])
Greg <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[1])
library(readxl)
library(tidyverse)
library(tidyverse)
library(readxl)
Greg <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[1])
members <- c("Greg", "Smit", "Julia", "Freya", "Leo")
Greg <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[1])
Greg <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[1])
Greg <- read_excel("E:/MQM_Courses/Term3/Intermediate finance/Intermediate_Finance/CriticalThinking/predictions.xlsx", sheet = sheet_names[1])
Smit <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[2])
Julia <- read_excel("./CriticalThinking/predictions.xlsx", sheet = sheet_names[3])
path <- "E:/MQM_Courses/Term3/Intermediate finance/Intermediate_Finance/CriticalThinking/predictions.xlsx"
path <- "E:/MQM_Courses/Term3/Intermediate finance/Intermediate_Finance/CriticalThinking/predictions.xlsx"
Greg <- read_excel(path, sheet = sheet_names[1])
Smit <- read_excel(path, sheet = sheet_names[2])
Julia <- read_excel(path, sheet = sheet_names[3])
Freya <- read_excel(path, sheet = sheet_names[4])
Leo <- read_excel(path, sheet = sheet_names[5])
orig.datas <- list(Greg,Smit,Julia,Freya,Leo)
GregLM <- lm(Greg~., data = Greg)
SmitLM <- lm(Smit~.,data = Smit)
JuliaLM <- lm(Julia~.,data = Julia)
FreyaLM <- lm(Freya~.,data = Freya)
LeoLM <- lm(Leo~.,data=Leo)
lmlist <- list(GregLM,SmitLM,JuliaLM)#,FreyaLM,LeoLM)
pval <- 0.05
JuliaLM
JuliaLM %>% summary()
path <- "E:/MQM_Courses/Term3/Intermediate finance/Intermediate_Finance/CriticalThinking/predictions.xlsx"
Julia <- read_excel(path, sheet = sheet_names[3])
JuliaLM <- lm(Julia~.,data = Julia)
JuliaLM %>% summary()
path <- "E:/MQM_Courses/Term3/Intermediate finance/Intermediate_Finance/CriticalThinking/predictions.xlsx"
Julia <- read_excel(path, sheet = sheet_names[3])
JuliaLM <- lm(Julia~.,data = Julia)
JuliaLM %>% summary()
for (i in seq(1,length(lmlist))){
Var = rownames(summary(lmlist[i])$coefficients)[summary(lmlist[i])$coefficients[,4] < pval]
}
pval <- 0.05
JuliaLM %>% summary()
pval <- 0.05
members <- c("Greg~", "Smit~", "Julia~", "Freya~", "Leo~")
newLM <- NULL
lm.n <- lm(as.formula(paste(members[i], paste(Var, collapse = " + "))), data = lmlist[i])
pval <- 0.05
members <- c("Greg~", "Smit~", "Julia~", "Freya~", "Leo~")
newLM <- NULL
for (i in seq(1,length(lmlist))){
Var = rownames(summary(lmlist[i])$coefficients)[summary(lmlist[i])$coefficients[,4] < pval]
lm.n <- lm(as.formula(paste(members[i], paste(Var, collapse = " + "))), data = lmlist[i])
newLM[i] = lm.n
}
GregLM <- lm(Greg~., data = Greg)
SmitLM <- lm(Smit~.,data = Smit)
JuliaLM <- lm(Julia~.,data = Julia)
FreyaLM <- lm(Freya~.,data = Freya)
LeoLM <- lm(Leo~.,data=Leo)
lmlist <- list(GregLM,SmitLM,JuliaLM)#,FreyaLM,LeoLM
pval <- 0.05
members <- c("Greg~", "Smit~", "Julia~", "Freya~", "Leo~")
newLM <- NULL
for (i in seq(1,length(lmlist))){
Var = rownames(summary(lmlist[i])$coefficients)[summary(lmlist[i])$coefficients[,4] < pval]
lm.n <- lm(as.formula(paste(members[i], paste(Var, collapse = " + "))), data = lmlist[i])
newLM[i] = lm.n
}
summary(lmlist[1])
lmlist[1]
lmsums <- list(summary(GregLM),summary(SmitLM),summary(JuliaLM))
lmsums[1]
Var = rownames(lmsums[i]$coefficients)[lmsums[i]$coefficients[,4] < pval]
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[i]$coefficients)[lmsums[i]$coefficients[,4] < pval]
lm.n <- lm(as.formula(paste(members[i], paste(Var, collapse = " + "))), data = lmlist[i])
newLM[i] = lm.n
}
pval <- 0.05
members <- c("Greg~", "Smit~", "Julia~", "Freya~", "Leo~")
newLM <- NULL
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[i]$coefficients)[lmsums[i]$coefficients[,4] < pval]
lm.n <- lm(as.formula(paste(members[i], paste(Var, collapse = " + "))), data = lmlist[i])
newLM[i] = lm.n
}
pval <- 0.05
members <- c("Greg ~ ", "Smit ~ ", "Julia ~ ", "Freya ~ ", "Leo ~ ")
newLM <- NULL
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[i]$coefficients)[lmsums[i]$coefficients[,4] < pval]
lm.n <- lm(as.formula(paste(members[i], paste(Var, collapse = " + "))), data = orig.datas[i])
newLM[i] = lm.n
}
orig.datas[1]
sheet_names <- c("Greg Judgements", "Smit Judgements", "Julia Judgements", "Freya Judgements", "Leo Judgements")
members <- c("Greg~", "Smit~", "Julia~", "Freya~", "Leo~")
path <- "E:/MQM_Courses/Term3/Intermediate finance/Intermediate_Finance/CriticalThinking/predictions.xlsx"
Greg <- read_excel(path, sheet = sheet_names[1])
Smit <- read_excel(path, sheet = sheet_names[2])
Julia <- read_excel(path, sheet = sheet_names[3])
Freya <- read_excel(path, sheet = sheet_names[4])
Leo <- read_excel(path, sheet = sheet_names[5])
orig.datas <- list(Greg,Smit,Julia,Freya,Leo)
orig.datas[1]
Julia
orig.datas
orig.datas[1]
GregLM <- lm(Greg~., data = Greg)
SmitLM <- lm(Smit~.,data = Smit)
JuliaLM <- lm(Julia~.,data = Julia)
FreyaLM <- lm(Freya~.,data = Freya)
LeoLM <- lm(Leo~.,data=Leo)
lmlist <- list(GregLM,SmitLM,JuliaLM)#,FreyaLM,LeoLM
lmsums <- list(summary(GregLM),summary(SmitLM),summary(JuliaLM))
orig.datas[1]
pval <- 0.05
orig.datas[1]
orig.datas[1]
orig.datas[1]
orig.datas[[1]]
orig.datas
View(orig.datas)
orig.datas
orig.datas[3]
orig.datas
orig.datas
orig.datas[1]
newLM <- NULL
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[i]$coefficients)[lmsums[i]$coefficients[,4] < pval]
lm.n <- lm(as.formula(paste(members[i], paste(Var, collapse = " + "))), data = orig.datas[i])
newLM[i] = lm.n
}
newLM <- list()
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[i]$coefficients)[lmsums[i]$coefficients[,4] < pval]
lm.n <- lm(as.formula(paste(members[i], paste(Var, collapse = " + "))), data = orig.datas[[i]])
newLM[i] = lm.n
}
lmsums[1]
lmsums[1]$coefficients
lmsums[[1]]$coefficients
Var = rownames(lmsums[[i]]$coefficients)[lmsums[[i]]$coefficients[,4] < pval]
newLM <- list()
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[[i]]$coefficients)[lmsums[[i]]$coefficients[,4] < pval]
lm.n <- lm(as.formula(paste(members[i], paste(Var, collapse = " + "))), data = orig.datas[[i]])
newLM[i] = lm.n
}
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[[i]]$coefficients)[lmsums[[i]]$coefficients[,4] < pval]
lm.n <- lm(as.formula(paste(members[i], paste(Var[-1], collapse = " + "))), data = orig.datas[[i]])
newLM[i] = lm.n
}
newLM
newLM[1]
newLM[1]%>% summary()
newLM[[1]]%>% summary()
summary(newLM[[1]])
View(lmsums)
View(newLM)
newLM[[1]]
newLM[[2]]
newLM[[3]]
newLM[[1]]
newLM[[2]]
newLM[[3]]
GregLM.N
newLM[[1]]
newLM[1]
newLM <- list()
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[[i]]$coefficients)[lmsums[[i]]$coefficients[,4] < pval]
lm.n = lm(as.formula(paste(members[i], paste(Var[-1], collapse = " + "))), data = orig.datas[[i]])
newLM[i] = lm.n
}
newLM[[1]]
newLM[[2]]
newLM[[3]]
View(newLM)
fit.resid <- list()
fit.resid.names <- c("GregFR", "SmitFR", "JuliaFR", "FreyaFR", "LeoFR")
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[[i]]$coefficients)[lmsums[[i]]$coefficients[,4] < pval]
lm.n = lm(as.formula(paste(members[i], paste(Var[-1], collapse = " + "))), data = orig.datas[[i]])
resids = lm.n$residuals
fits = lm.n$fitted.values
newLM[i] = lm.n
fit.resid[i] = data.frame(fit.resid.names[i] = orig.datas[[i]][,17], fits = fits, resids = resids)
fit.resid[i] = data.frame(predicts = orig.datas[[i]][,17], fits = fits, resids = resids)
members <- c("Greg ~ ", "Smit ~ ", "Julia ~ ", "Freya ~ ", "Leo ~ ")
newLM <- list()
fit.resid <- list()
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[[i]]$coefficients)[lmsums[[i]]$coefficients[,4] < pval]
lm.n = lm(as.formula(paste(members[i], paste(Var[-1], collapse = " + "))), data = orig.datas[[i]])
resids = lm.n$residuals
fits = lm.n$fitted.values
newLM[i] = lm.n
fit.resid[i] = data.frame(predicts = orig.datas[[i]][,17], fits = fits, resids = resids)
}
newLM[[1]]
newLM[[2]]
newLM[[3]]
fit.resid
fit.resid[1]
View(fit.resid)
orig.datas[[i]][,17]
orig.datas[[1]][,17]
data.frame(predicts = orig.datas[[i]][,17], fits = fits, resids = resids)
fit.resid <- list()
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[[i]]$coefficients)[lmsums[[i]]$coefficients[,4] < pval]
lm.n = lm(as.formula(paste(members[i], paste(Var[-1], collapse = " + "))), data = orig.datas[[i]])
resids = lm.n$residuals
fits = lm.n$fitted.values
newLM[i] = lm.n
fit.resid[i] = data.frame(predicts = orig.datas[[i]][,17], fits = fits, resids = resids)
}
newLM <- list()
fit.resid <- list()
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[[i]]$coefficients)[lmsums[[i]]$coefficients[,4] < pval]
lm.n = lm(as.formula(paste(members[i], paste(Var[-1], collapse = " + "))), data = orig.datas[[i]])
resids = lm.n$residuals
fits = lm.n$fitted.values
newLM[i] = lm.n
newdata = data.frame(predicts = orig.datas[[i]][,17], fits = fits, resids = resids)
fit.resid <- c(fit.resid, list(newdata))
}
fit.resid
fit.resid[1]
fit.resid[[1]]
fit.resid[[1]][,1]
corrs = NULL
for (i in seq(1,length(fit.resid))){
data = fit.resid[i]
corr = cor(fit.resid[[i]][,1],fit.resid[[i]][,2])
corrs[i] = corr
}
corrs
read_excel("./CriticalThinking/salaries.xlsx")
read_excel("E:/MQM_Courses/Term3/Intermediate finance/Intermediate_Finance/CriticalThinking/salaries.xlsx")
salaries <- read_excel("E:/MQM_Courses/Term3/Intermediate finance/Intermediate_Finance/CriticalThinking/salaries.xlsx")
salaries
View(Greg)
Greg <- read_excel(path, sheet = sheet_names[1]) %>% sort(Institution, decreasing = FALSE)
Greg <- read_excel(path, sheet = sheet_names[1]) %>% arrange(Institution)
View(Greg)
sheet_names <- c("Greg Judgements", "Smit Judgements", "Julia Judgements", "Freya Judgements", "Leo Judgements")
path <- "E:/MQM_Courses/Term3/Intermediate finance/Intermediate_Finance/CriticalThinking/predictions.xlsx"
Greg <- read_excel(path, sheet = sheet_names[1]) %>% arrange(Institution)
Smit <- read_excel(path, sheet = sheet_names[2]) %>% arrange(Institution)
Julia <- read_excel(path, sheet = sheet_names[3]) %>% arrange(Institution)
Freya <- read_excel(path, sheet = sheet_names[4]) %>% arrange(Institution)
Leo <- read_excel(path, sheet = sheet_names[5]) %>% arrange(Institution)
orig.datas <- list(Greg,Smit,Julia,Freya,Leo)
orig.datas[3]
GregLM <- lm(Greg~., data = Greg)
SmitLM <- lm(Smit~.,data = Smit)
JuliaLM <- lm(Julia~.,data = Julia)
FreyaLM <- lm(Freya~.,data = Freya)
LeoLM <- lm(Leo~.,data=Leo)
lmlist <- list(GregLM,SmitLM,JuliaLM)#,FreyaLM,LeoLM
lmsums <- list(summary(GregLM),summary(SmitLM),summary(JuliaLM))
pval <- 0.05
members <- c("Greg ~ ", "Smit ~ ", "Julia ~ ", "Freya ~ ", "Leo ~ ")
newLM <- list()
fit.resid <- list()
for (i in seq(1,length(lmsums))){
Var = rownames(lmsums[[i]]$coefficients)[lmsums[[i]]$coefficients[,4] < pval]
lm.n = lm(as.formula(paste(members[i], paste(Var[-1], collapse = " + "))), data = orig.datas[[i]])
resids = lm.n$residuals
fits = lm.n$fitted.values
newLM[i] = lm.n
newdata = data.frame(predicts = orig.datas[[i]][,17], fits = fits, resids = resids)
fit.resid <- c(fit.resid, list(newdata))
}
newLM[[1]]
newLM[[2]]
fit.resid[[1]]
fit.resid[[1]][,1]
corrs = NULL
for (i in seq(1,length(fit.resid))){
data = fit.resid[i]
corr = cor(fit.resid[[i]][,1],fit.resid[[i]][,2])
corrs[i] = corr
}
corrs
salaries <- read_excel("E:/MQM_Courses/Term3/Intermediate finance/Intermediate_Finance/CriticalThinking/salaries.xlsx")
corrs2 = NULL
corrs2 = NULL
for (i in seq(1,length(fit.resid))){
data = fit.resid[[i]]
corr = cor(data[,1],salaries)
corrs2[i] = corr
}
corrs2
Rs = NULL
for (i in seq(1,length(fit.resid))){
data = fit.resid[i]
corr = cor(fit.resid[[i]][,1],fit.resid[[i]][,2])
Rs[i] = corr
}
Rs
Ra = NULL
for (i in seq(1,length(fit.resid))){
data = fit.resid[[i]]
corr = cor(data[,1],salaries)
Ra[i] = corr
}
Ra
round(Rs,2)
round(Rs,4)
newLM[[3]]
newLM[[3]]
View(Greg)
